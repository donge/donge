<strong>[VB]控制网页的FORMS行为<br /><br /></strong>Private Sub Command2_Click()<br />    With WebBrowser1.Document.Forms(0)<br />        .c2.Checked = 1<br />        .r1(1).Checked = 1<br />    End With<br />End Sub<br /><br /><br />Private Sub Command2_Click()<br />    With WebBrowser1.Document.Forms(0)<br />        .d1.Options(1).Selected = 1<br />    End With<br />End Sub<br /><br />web.Document.getElementsByName(&quot;D1&quot;).Item(0).selectedIndex = 1<br /><br />＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝<br />&lt;input type=&quot;radio&quot; value=&quot;n&quot; checked name=&quot;notecome&quot;&gt;普通<br />&lt;input type=&quot;radio&quot; value=&quot;c&quot; name=&quot;notecome&quot;&gt;原创<br />&lt;input type=&quot;radio&quot; value=&quot;z&quot; name=&quot;notecome&quot;&gt;转帖<br />&lt;input type=&quot;button&quot; value=&quot;发送提交&quot; name=&quot;button&quot;<br /><br />比如一个网页里有如上代码<br />我想选择原创<br />webbrowser中怎么写<br /><br /><br />Private Sub Command1_Click()<br />    WebBrowser1.Navigate &quot;c:\\ggg.html&quot;<br />End Sub<br /><br />Private Sub Command2_Click()<br />    Dim x<br />    <br />    For Each x In WebBrowser1.Document.All(&quot;notecome&quot;)<br />        If x.Value = &quot;c&quot; Then<br />            x.Checked = True<br />        End If<br />    Next<br />End Sub<br /><br />============================================================================================<br />假设你的HTML代码如下：<br /><br />&lt;html&gt;<br />&lt;script&gt;<br />  function abcd()&leftsign;<br />    alert(&quot;haha&quot;);<br />    return false;<br />  &rightsign;<br />&lt;/script&gt;<br /><br />&lt;body&gt;<br />  &lt;a id = \'xxx\' href=# onclick=&quot;abcd()&quot;&gt;ggggg&lt;/a&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br /><br />VB代码如下：<br />Private Sub Command1_Click()<br />    WebBrowser1.Navigate &quot;http://www.applevb.com/script_test.html&quot;<br />End Sub<br /><br />Private Sub Command2_Click()<br />    Dim a, b<br />    Dim d As IHTMLDocument2<br />    <br />    For Each a In WebBrowser1.Document.All<br />        Debug.Print a.tagName<br />        If (a.tagName = &quot;SCRIPT&quot;) Then<br /><br />        End If<br />        If (a.tagName = &quot;A&quot;) Then<br />            If a.Id = &quot;xxx&quot; Then<br />                a.FireEvent (&quot;onclick&quot;)<br />            End If<br />        End If<br />    Next<br /><br />点击Command1浏览这个网页，点击Command2运行其中的脚本abcd。<br /><br /><br />＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝<br /><br />怎么编程把用户名，密码提交到网页上的登录页？<br />首先在程序中加入Webbrowser控件并加入引用 Microsoft HTML Object Library。<br />假设你的HTML页面表单代码如下：<br />&lt;form method=&quot;POST&quot; action=&quot;http://chen/dll/chat/chatmain.exe/RegUser&quot;&gt;<br />  &lt;p&gt;请填写下面表单注册（*项为必添项）&lt;/p&gt;<br />  &lt;p&gt;*姓名&lt;input type=&quot;text&quot; name=&quot;Name&quot; size=&quot;20&quot;&gt;&lt;/p&gt;<br />  &lt;p&gt;*昵称&lt;input type=&quot;text&quot; name=&quot;NickName&quot; size=&quot;20&quot;&gt;&lt;/p&gt;<br />  &lt;p&gt;电子邮件&lt;input type=&quot;text&quot; name=&quot;EMail&quot; size=&quot;20&quot;&gt;&lt;/p&gt;<br />  &lt;p&gt;*密码&lt;input type=&quot;text&quot; name=&quot;Password&quot; size=&quot;20&quot;&gt;&lt;/p&gt;<br />  &lt;p&gt;&lt;input type=&quot;submit&quot; value=&quot;提交&quot; name=&quot;B1&quot;&gt;&lt;input type=&quot;reset&quot; value=&quot;全部重写&quot; name=&quot;B2&quot;&gt;&lt;/p&gt;<br />&lt;/form&gt;<br />注意其中元素的type、Name、value属性。然后VB中的代码如下：<br />Private Sub Command1_Click()<br />    WebBrowser1.Navigate &quot;http://chen/chat/newuser.htm&quot;<br />End Sub<br /><br />Private Sub WebBrowser1_DocumentComplete(ByVal pDisp As Object, URL As Variant)<br />    Dim vDoc, vTag<br />    Dim i As Integer<br />      <br />    Set vDoc = WebBrowser1.Document<br />    List1.Clear<br />    For i = 0 To vDoc.All.length - 1<br />        If UCase(vDoc.All(i).tagName) = &quot;INPUT&quot; Then<br />            Set vTag = vDoc.All(i)<br />            If vTag.Type = &quot;text&quot; Or vTag.Type = &quot;password&quot; Then<br />                List1.AddItem vTag.Name<br />                Select Case vTag.Name<br />                    Case &quot;Name&quot;<br />                        vTag.Value = &quot;IMGod&quot;<br />                    Case &quot;NickName&quot;<br />                        vTag.Value = &quot;IMGod&quot;<br />                    Case &quot;Password&quot;<br />                        vTag.Value = &quot;IMGodpass&quot;<br />                    Case &quot;EMail&quot;<br />                        vTag.Value = &quot;[email]IMGod@paradise.com[/email]&quot;<br />                End Select<br />            ElseIf vTag.Type = &quot;submit&quot; Then<br />                vTag.Click<br />            End If<br />        End If<br />    Next i<br />End Sub<br />点击Command1就可以自动填表并提交了。 <br /><br /><br />=====================================================================================<br />调用forms下的Submit控件的Click事件,我会做,但我不想这么做.<br /><br />有没有办法直接调用类似于:web1.document.forms.submit,这句语句我怎么写都不成功<br />是这个<br />Webbrowser1.document.formName.submit()<br /><br />不能用,formname为form1所以我调用Webbrowser1.document.form1.submit<br />出错类型:对象不支持该属性或方法,<br />然后调用Webbrowser1.document.forms(0).submit()<br />出错类型同上<br />Private Sub Command1_Click()<br />    WebBrowser1.Navigate &quot;http://localhost/webapplication2/MyLogonPage.aspx&quot;<br />End Sub<br /><br />Private Sub Command2_Click()<br />    WebBrowser1.Document.All(&quot;Form1&quot;).submit<br />End Sub<br />&lt;form name=&quot;form1&quot; method=&quot;post&quot; action=&quot;aa.asp&quot;&gt;<br />......<br />&lt;input name=&quot;reset&quot; type=&quot;reset&quot; vlaue=&quot;reset&quot; class=&quot;button&quot;&gt;<br />&lt;/form&gt;<br />我本想把reset的type改成submit 再提交,可出错,type是只读属性,不能修改,我只要有办法把这页面递交出去就行,当然,用POST也不行,参数太多,组合方式太多<br /><br /><br />你用下面的代码试一下你的页面：<br /><br /><br />Private Sub Command1_Click()<br />    WebBrowser1.Navigate &quot;http://oakhome.xicp.net/webapplication2/MyLogonPage.aspx&quot;<br />End Sub<br /><br />Private Sub Command2_Click()<br />    Dim x<br />    <br />    On Error Resume Next<br />    For Each x In WebBrowser1.Document.All<br />        List1.AddItem x.Name<br />    Next<br />End Sub<br /><br />看看在List1里面列出来的页<θθθ>95|